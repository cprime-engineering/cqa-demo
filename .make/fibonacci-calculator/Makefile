
#--------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------
# Name: fibonacci-calculator
# Description: A spring boot microservice implementation for the Fibonacci DevOps demo.
#--------------------------------------------------------------------------------------------------------------
#--------------------------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------------------------
#
# Begin fibonacci-calculator make targets
#
#--------------------------------------------------------------------------------------------------------------

#--------------------------------------------------------------------------------------------------------------
# run local
#--------------------------------------------------------------------------------------------------------------
# Run the fibonacci-calculator locally within the developer IDE using docker.
#--------------------------------------------------------------------------------------------------------------
fibonacci-calculator/run-local: fibonacci-calculator/containerize-local
	docker run -p 8080:8080 fibonacci-calculator:latest

#--------------------------------------------------------------------------------------------------------------
# containerize local
#--------------------------------------------------------------------------------------------------------------
# Package the fibonacci-calculator in a docker container and publish locally.
#--------------------------------------------------------------------------------------------------------------
fibonacci-calculator/containerize-local: fibonacci-calculator/package-local
	docker build -f ./micro-services/fibonacci-calculator/Dockerfile -t fibonacci-calculator:latest ./micro-services/fibonacci-calculator

#--------------------------------------------------------------------------------------------------------------
# package local
#--------------------------------------------------------------------------------------------------------------
# Package the fibonacci-calculator java application in a JAR.
#--------------------------------------------------------------------------------------------------------------
fibonacci-calculator/package-local:
	cd ./micro-services/fibonacci-calculator && mvn package

#--------------------------------------------------------------------------------------------------------------
# scan local
#--------------------------------------------------------------------------------------------------------------
# Scan the fibonacci-calculator in container for vulnerabilities.
#--------------------------------------------------------------------------------------------------------------
fibonacci-calculator/scan-local: fibonacci-calculator/containerize-local
	grype fibonacci-calculator:latest
	snyk container test  fibonacci-calculator:latest

#--------------------------------------------------------------------------------------------------------------
#
# End fibonacci-calculator make targets
#
#--------------------------------------------------------------------------------------------------------------
